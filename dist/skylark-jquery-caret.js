/**
 * skylark-jquery-caret - A version of jquery caret that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-jquery-caret/
 * @license MIT
 */
!function(e,t){var n=t.define,require=t.require,r="function"==typeof n&&n.amd,a=!r&&"undefined"!=typeof exports;if(!r&&!n){var o={};n=t.define=function(e,t,n){"function"==typeof n?(o[e]={factory:n,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var n=t.split("/"),r=e.split("/");n.pop();for(var a=0;a<r.length;a++)"."!=r[a]&&(".."==r[a]?n.pop():n.push(r[a]));return n.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):o[e]={factory:null,resolved:!0,exports:n}},require=t.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=o[e];if(!module.resolved){var n=[];module.deps.forEach(function(e){n.push(require(e))}),module.exports=module.factory.apply(t,n)||null,module.resolved=!0}return module.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-jquery-caret/caret",["skylark-jquery"],function(e){var t=document.createElement("input"),n={setSelectionRange:"setSelectionRange"in t||"selectionStart"in t,createTextRange:"createTextRange"in t||"selection"in document},r=/\r\n/g,a=/\r/g,o=function(t){return void 0!==t.value?t.value:e(t).text()},i=function(e,t){var n=o(e).replace(a,""),r=n.length;return void 0===t&&(t=r),(t=Math.floor(t))<0&&(t=r+t),t<0&&(t=0),t>r&&(t=r),t},c=function(e,t,n,r){this.start=e||0,this.end=t||0,this.length=n||0,this.text=r||""};c.prototype.toString=function(){return JSON.stringify(this,null,"    ")};var l=function(e){if(e)return n.setSelectionRange?function(e){return e.selectionStart}(e):n.createTextRange?function(e){var t,n,a,i,c;if(e.focus(),e.focus(),(t=document.selection.createRange())&&t.parentElement()===e)return a=o(e),i=a.length,(n=e.createTextRange()).moveToBookmark(t.getBookmark()),(c=e.createTextRange()).collapse(!1),n.compareEndPoints("StartToEnd",c)>-1?a.replace(r,"\n").length:-n.moveStart("character",-i);return 0}(e):void 0},s=function(e,t){e.focus(),t=i(e,t),n.setSelectionRange?function(e,t){e.setSelectionRange(t,t)}(e,t):n.createTextRange&&function(e,t){var n=e.createTextRange();n.move("character",t),n.select()}(e,t)},u=function(t,n){var r=l(t),i=o(t).replace(a,""),c=+(r+n.length+(i.length-r)),u=+t.getAttribute("maxlength");if(function(e,t){return e.hasAttribute?e.hasAttribute(t):void 0!==e[t]}(t,"maxlength")&&c>u){var f=n.length-(c-u);n=n.substr(0,f)}!function(t,n){void 0!==t.value?t.value=n:e(t).text(n)}(t,i.substr(0,r)+n+i.substr(r)),s(t,r+n.length)},f=function(e){if(e)return n.setSelectionRange?function(e){var t=new c;t.start=e.selectionStart,t.end=e.selectionEnd;var n=Math.min(t.start,t.end),r=Math.max(t.start,t.end);return t.length=r-n,t.text=o(e).substring(n,r),t}(e):n.createTextRange?function(e){var t=new c;e.focus();var n=document.selection.createRange();if(n&&n.parentElement()===e){var r,a,i,l,s=0,u=0,f=o(e);r=f.length,a=f.replace(/\r\n/g,"\n"),(i=e.createTextRange()).moveToBookmark(n.getBookmark()),(l=e.createTextRange()).collapse(!1),i.compareEndPoints("StartToEnd",l)>-1?s=u=r:(s=-i.moveStart("character",-r),s+=a.slice(0,s).split("\n").length-1,i.compareEndPoints("EndToEnd",l)>-1?u=r:(u=-i.moveEnd("character",-r),u+=a.slice(0,u).split("\n").length-1)),s-=f.substring(0,s).split("\r\n").length-1,u-=f.substring(0,u).split("\r\n").length-1,t.start=s,t.end=u,t.length=t.end-t.start,t.text=a.substr(t.start,t.length)}return t}(e):void 0},g=function(e,t,r){t=i(e,t),r=i(e,r),n.setSelectionRange?function(e,t,n){e.setSelectionRange(t,n)}(e,t,r):n.createTextRange&&function(e,t,n){var r=e.createTextRange();r.moveEnd("textedit",-1),r.moveStart("character",t),r.moveEnd("character",n-t),r.select()}(e,t,r)},h=function(t){var r=e(t);r.is("input, textarea")||t.select?r.select():n.setSelectionRange?function(e){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}(t):n.createTextRange&&function(e){var t=document.body.createTextRange();t.moveToElementText(e),t.select()}(t)};return e.extend(e.fn,{caret:function(){var e=this.filter("input, textarea");if(0===arguments.length){var t=e.get(0);return l(t)}if("number"==typeof arguments[0]){var n=arguments[0];e.each(function(e,t){s(t,n)})}else{var r=arguments[0];e.each(function(e,t){u(t,r)})}return this},range:function(){var t=this.filter("input, textarea");if(0===arguments.length){var n=t.get(0);return f(n)}if("number"==typeof arguments[0]){var r=arguments[0],a=arguments[1];t.each(function(e,t){g(t,r,a)})}else{var o=arguments[0];t.each(function(t,n){!function(t,n){var r=e(t),a=r.val(),o=f(t),i=+(o.start+n.length+(a.length-o.end)),c=+r.attr("maxlength");if(r.is("[maxlength]")&&i>c){var l=n.length-(i-c);n=n.substr(0,l)}var s=a.substr(0,o.start),u=a.substr(o.end);r.val(s+n+u);var h=o.start,v=h+n.length;g(t,o.length?h:v,v)}(n,o)})}return this},selectAll:function(){return this.each(function(e,t){h(t)})}}),e.extend(e,{deselectAll:function(){return document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this}}),e}),e("skylark-jquery-caret/main",["./caret"],function(e){return e}),e("skylark-jquery-caret",["skylark-jquery-caret/main"],function(e){return e})}(n),!r){var i=require("skylark-langx/skylark");a?module.exports=i:t.skylarkjs=i}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-jquery-caret.js.map
